{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.6", "generated_at": "2026-02-28T14:58:05.992904Z", "invocation_id": "b828fc4c-9fd0-49c2-93ed-2b3a3188560f", "invocation_started_at": "2026-02-28T14:57:56.588387Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T14:58:01.336997Z", "completed_at": "2026-02-28T14:58:01.380444Z"}, {"name": "execute", "started_at": "2026-02-28T14:58:01.382576Z", "completed_at": "2026-02-28T14:58:03.149719Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8170921802520752, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.civic_affordability.mart_affordability_index_annual", "compiled": true, "compiled_code": "WITH metric_values AS (\n    SELECT\n        fm.geo_id,\n        dt.year,\n        dg.state_abbrev,\n        dm.metric_name,\n        fm.value\n    FROM \"postgres\".\"raw\".\"fact_metric\" fm\n    JOIN \"postgres\".\"raw\".\"dim_time\" dt ON dt.period_id = fm.period_id\n    JOIN \"postgres\".\"raw\".\"dim_geo\" dg ON dg.geo_id = fm.geo_id\n    JOIN \"postgres\".\"raw\".\"dim_metric\" dm ON dm.metric_id = fm.metric_id\n),\nwide_values AS (\n    SELECT\n        geo_id,\n        state_abbrev,\n        year,\n        MAX(CASE WHEN metric_name = 'income_real' THEN value END) AS income_real,\n        MAX(CASE WHEN metric_name = 'housing_hpi' THEN value END) AS housing_hpi,\n        MAX(CASE WHEN metric_name = 'healthcare_pc' THEN value END) AS healthcare_pc,\n        MAX(CASE WHEN metric_name = 'childcare_annual' THEN value END) AS childcare_annual\n    FROM metric_values\n    GROUP BY geo_id, state_abbrev, year\n),\nbase_values AS (\n    SELECT\n        geo_id,\n        MAX(CASE WHEN year = 2003 THEN income_real END) AS income_base,\n        MAX(CASE WHEN year = 2003 THEN housing_hpi END) AS housing_base,\n        MAX(CASE WHEN year = 2003 THEN healthcare_pc END) AS healthcare_base,\n        MAX(CASE WHEN year = 2003 THEN childcare_annual END) AS childcare_base\n    FROM wide_values\n    GROUP BY geo_id\n)\nSELECT\n    w.geo_id,\n    w.state_abbrev,\n    w.year,\n    w.income_real,\n    w.housing_hpi,\n    w.healthcare_pc,\n    w.childcare_annual,\n    (w.income_real / NULLIF(b.income_base, 0)) * 100.0 AS income_index,\n    (w.housing_hpi / NULLIF(b.housing_base, 0)) * 100.0 AS housing_index,\n    (w.healthcare_pc / NULLIF(b.healthcare_base, 0)) * 100.0 AS healthcare_index,\n    (w.childcare_annual / NULLIF(b.childcare_base, 0)) * 100.0 AS childcare_index\nFROM wide_values w\nJOIN base_values b ON b.geo_id = w.geo_id\nORDER BY w.geo_id, w.year", "relation_name": "\"postgres\".\"analytics\".\"mart_affordability_index_annual\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T14:58:01.347517Z", "completed_at": "2026-02-28T14:58:01.352865Z"}, {"name": "execute", "started_at": "2026-02-28T14:58:01.353921Z", "completed_at": "2026-02-28T14:58:03.215488Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8806540966033936, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.civic_affordability.mart_policy_events_direct", "compiled": true, "compiled_code": "SELECT\n    fpe.event_id,\n    fpe.geo_id,\n    dg.state_abbrev,\n    fpe.year,\n    fpe.short_label,\n    fpe.summary,\n    fpe.category\nFROM \"postgres\".\"raw\".\"fact_policy_event\" fpe\nJOIN \"postgres\".\"raw\".\"dim_geo\" dg ON dg.geo_id = fpe.geo_id\nWHERE fpe.impact_level = 'direct'\nORDER BY fpe.year, fpe.event_id", "relation_name": "\"postgres\".\"analytics\".\"mart_policy_events_direct\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-28T14:58:03.163769Z", "completed_at": "2026-02-28T14:58:03.169549Z"}, {"name": "execute", "started_at": "2026-02-28T14:58:03.169862Z", "completed_at": "2026-02-28T14:58:04.865315Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.704455852508545, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.civic_affordability.mart_cost_pressure_annual", "compiled": true, "compiled_code": "WITH affordability AS (\n    SELECT * FROM \"postgres\".\"analytics\".\"mart_affordability_index_annual\"\n)\nSELECT\n    geo_id,\n    state_abbrev,\n    year,\n    (housing_index + healthcare_index + childcare_index) / 3.0 AS cost_pressure_index,\n    ((housing_index + healthcare_index + childcare_index) / 3.0) - income_index AS affordability_gap_index\nFROM affordability\nORDER BY geo_id, year", "relation_name": "\"postgres\".\"analytics\".\"mart_cost_pressure_annual\"", "batch_results": null}], "elapsed_time": 8.627892017364502, "args": {"state_modified_compare_vars": false, "populate_cache": true, "partial_parse": true, "log_path": "/Users/brentondickerson/git/breathe/civic_affordability_pg/dbt/logs", "require_unique_project_resource_names": false, "cache_selected_only": false, "log_format_file": "debug", "show_all_deprecations": false, "empty": false, "log_format": "default", "introspect": true, "log_level": "info", "defer": false, "favor_state": false, "macro_debugging": false, "print": true, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "profiles_dir": ".dbt", "static_parser": true, "invocation_command": "dbt run --profiles-dir .dbt", "project_dir": "/Users/brentondickerson/git/breathe/civic_affordability_pg/dbt", "vars": {}, "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "printer_width": 80, "select": [], "write_json": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "exclude": [], "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "use_fast_test_edges": false, "require_nested_cumulative_type_params": false, "require_all_warnings_handled_by_warn_error": false, "source_freshness_run_project_hooks": true, "require_ref_searches_node_package_before_root": false, "use_colors": true, "version_check": true, "which": "run", "log_level_file": "debug", "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "quiet": false, "strict_mode": false, "require_generic_test_arguments_property": true, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": true, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true}}